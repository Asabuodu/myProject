<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LANRE GLOBAL FIT — Admin</title>
  <link rel="icon" href="logo.png" />
  <style>
    :root{--bg:#efe9df;--text:#362b26;--accent:#c49a6c;--muted:#7a6a63;--card:#fff}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#efe7dd);color:var(--text);font-family:Inter,Arial}
    .wrap{max-width:1100px;margin:24px auto;padding:18px}
    header{display:flex;gap:12px;align-items:center}
    .logo{width:72px;height:72px}
    .admin-grid{display:grid;grid-template-columns:1fr 360px;gap:18px;margin-top:18px}
    .card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,0.06)}
    .field{display:flex;flex-direction:column;gap:8px;margin-bottom:10px}
    .admin-list{max-height:420px;overflow:auto}
    .btn{padding:10px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
    .btn-primary{background:var(--accent);color:#fff}
    .btn-outline{background:transparent;border:1px solid rgba(0,0,0,0.08)}
    @media(max-width:980px){ .admin-grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <img src="logo.png" alt="logo" class="logo">
      <div>
        <h2 style="margin:0">LANRE GLOBAL FIT — Admin</h2>
        <div class="muted">Manage products (upload / edit / delete)</div>
      </div>
    </header>

    <div id="loginCard" class="card" style="margin-top:18px">
      <h3>Enter Admin Password</h3>
      <input id="adminPw" type="password" placeholder="Password" style="padding:10px;width:100%;border-radius:8px;border:1px solid #eee">
      <div style="margin-top:8px;display:flex;gap:8px">
        <button id="btnEnter" class="btn btn-primary">Enter</button>
        <a href="index.html" class="btn btn-outline" style="display:inline-flex;align-items:center;justify-content:center">Back to site</a>
      </div>
      <small style="display:block;margin-top:8px;color:var(--muted)">Default password: <strong>lanreadmin</strong>. Change in code for production.</small>
    </div>

    <div id="adminPanel" style="display:none;margin-top:18px">
      <div class="admin-grid">
        <div class="card">
          <h3>Add New Item</h3>
          <div class="field">
            <label>Item name</label>
            <input id="itemName" type="text" placeholder="Oxford Classic — Brown" style="padding:8px;border-radius:6px;border:1px solid #eee">
          </div>
          <div class="field">
            <label>Price (NGN)</label>
            <input id="itemPrice" type="number" placeholder="35500" style="padding:8px;border-radius:6px;border:1px solid #eee">
          </div>
          <div class="field">
            <label>Image (JPG/PNG)</label>
            <input id="itemImage" type="file" accept="image/*">
          </div>
          <div style="display:flex;gap:8px">
            <button id="addBtn" class="btn btn-primary">Add Item</button>
            <button id="exportBtn" class="btn btn-outline">Export JSON</button>
            <button id="importBtn" class="btn btn-outline">Import JSON</button>
            <input id="importFile" type="file" accept="application/json" style="display:none">
          </div>
          <div style="margin-top:12px;color:var(--muted)">Images are stored as Data URLs in localStorage for this demo. For production move images to server/cloud and store paths in your DB.</div>
        </div>

        <aside class="card">
          <h3>Existing Items</h3>
          <div id="adminList" class="admin-list"></div>
        </aside>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px">
        <button id="logoutBtn" class="btn btn-outline">Logout</button>
        <a href="index.html" class="btn">View Store</a>
      </div>
    </div>
  </div>

  <script>
    // Config
    const STORAGE_KEY = 'lgf_products_v2';
    const ADMIN_PASSWORD = 'lanreadmin';

    const defaultProducts = [
      {id:1,name:'Oxford Classic — Brown',price:35500,img:'https://images.unsplash.com/photo-1519741496550-3f2f8f053b02?q=80&w=1200',desc:''},
      {id:2,name:'Derby Heritage — Tan',price:28900,img:'https://images.unsplash.com/photo-1526178615157-5f1d9c09e8ae?q=80&w=1200',desc:''}
    ];

    function loadProducts(){
      try{ const raw = localStorage.getItem(STORAGE_KEY); if(!raw){ localStorage.setItem(STORAGE_KEY, JSON.stringify(defaultProducts)); return defaultProducts.slice(); } return JSON.parse(raw); }catch(e){ return defaultProducts.slice(); }
    }
    function saveProducts(arr){ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }

    let products = loadProducts();

    // DOM refs
    const loginCard = document.getElementById('loginCard');
    const adminPanel = document.getElementById('adminPanel');
    const adminList = document.getElementById('adminList');

    document.getElementById('btnEnter').addEventListener('click', ()=>{
      const pw = document.getElementById('adminPw').value;
      if(pw === ADMIN_PASSWORD){
        loginCard.style.display = 'none';
        adminPanel.style.display = 'block';
        renderAdminList();
      } else alert('Incorrect password');
    });

    document.getElementById('logoutBtn').addEventListener('click', ()=>{ adminPanel.style.display='none'; loginCard.style.display='block'; document.getElementById('adminPw').value=''; });

    async function fileToDataUrl(file){ return new Promise((res,rej)=>{ const r=new FileReader(); r.onload=()=>res(r.result); r.onerror=rej; r.readAsDataURL(file); }); }

    document.getElementById('addBtn').addEventListener('click', async ()=>{
      const name = document.getElementById('itemName').value.trim();
      const price = Number(document.getElementById('itemPrice').value);
      const file = document.getElementById('itemImage').files[0];
      if(!name || !price || !file){ alert('Please provide name, price and image'); return; }
      const img = await fileToDataUrl(file);
      const id = Date.now();
      const item = {id,name,price,img,desc:''};
      products.unshift(item);
      saveProducts(products);
      renderAdminList();
      alert('Item added');
      document.getElementById('itemName').value=''; document.getElementById('itemPrice').value=''; document.getElementById('itemImage').value='';
    });

    document.getElementById('exportBtn').addEventListener('click', ()=>{
      const data = JSON.stringify(products, null, 2);
      const blob = new Blob([data], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='lgf_products.json'; a.click(); URL.revokeObjectURL(url);
    });

    document.getElementById('importBtn').addEventListener('click', ()=>{ document.getElementById('importFile').click(); });
    document.getElementById('importFile').addEventListener('change', (e)=>{
      const f = e.target.files[0]; if(!f) return;
      const r = new FileReader();
      r.onload = ()=>{ try{ const arr = JSON.parse(r.result); if(Array.isArray(arr)){ products = arr; saveProducts(products); renderAdminList(); alert('Imported'); } else alert('Invalid file'); }catch(err){ alert('Invalid JSON'); } };
      r.readAsText(f);
    });

    function renderAdminList(){
      adminList.innerHTML = products.map(p=>`
        <div style="display:flex;gap:8px;align-items:center;padding:8px;border-bottom:1px solid #eee">
          <img src="${p.img}" style="width:72px;height:72px;object-fit:cover;border-radius:8px">
          <div style="flex:1">
            <div style="font-weight:700">${escapeHtml(p.name)}</div>
            <div style="color:var(--muted)">${formatNaira(p.price)}</div>
          </div>
          <div style="display:flex;flex-direction:column;gap:6px">
            <button class="edit btn btn-outline" data-id="${p.id}">Edit</button>
            <button class="delete btn btn-outline" data-id="${p.id}">Delete</button>
          </div>
        </div>
      `).join('');
      // attach handlers
      adminList.querySelectorAll('.delete').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          if(!confirm('Delete this item?')) return;
          const id = Number(btn.dataset.id);
          products = products.filter(x=>x.id!==id);
          saveProducts(products); renderAdminList();
        });
      });
      adminList.querySelectorAll('.edit').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = Number(btn.dataset.id);
          const p = products.find(x=>x.id===id);
          const newName = prompt('New name', p.name); if(newName===null) return;
          const newPrice = prompt('New price (NGN)', p.price); if(newPrice===null) return;
          p.name = newName; p.price = Number(newPrice);
          saveProducts(products); renderAdminList();
        });
      });
    }

    // small helper functions
    function formatNaira(n){ const parts = Number(n).toFixed(2).split('.'); parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ","); return '₦' + parts.join('.'); }
    function escapeHtml(s){ return (s||'').toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    // initial focus
    document.getElementById('adminPw').focus();
  </script>
</body>
</html>
